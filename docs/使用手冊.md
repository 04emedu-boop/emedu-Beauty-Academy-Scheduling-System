# 美業教室排課系統 - 使用者操作手冊 (v1.0)

## 1. 系統簡介
本系統專為美業學院設計，提供老師線上查詢教室空堂並進行預約登記。系統支援多地區 (台北、台中、高雄) 不同資料庫的切換，並即時同步至 Google 試算表。

---

## 2. 快速開始

### 啟動系統 (開發環境)
如果您是在本機電腦上執行此系統，請開啟終端機 (Terminal) 並輸入：
```bash
npm run dev
```
啟動後，請使用瀏覽器開啟：[http://localhost:3000](http://localhost:3000)

---

## 3. Google Apps Script 後端部署 (關鍵設定)
本系統依賴 Google Apps Script (GAS) 作為後端與資料庫連接。若您修改了 `Code.gs` 或需要更新後端邏輯，**必須** 依照以下步驟重新部署，否則前端網頁不會生效。

1.  **進入 GAS 編輯器**：
    *   開啟您的 Google 試算表 -> 擴充功能 -> Apps Script。
2.  **貼上程式碼**：
    *   將專案中 `docs/Code.gs` 的完整程式碼複製並覆蓋 GAS 編輯器內容。
3.  **部署新版本 (最重要的一步！)**：
    *   點擊右上角藍色 **「部署」 (Deploy)** -> **「管理部署作業」 (Manage deployments)**。
    *   點擊右上角的 **「筆 (編輯)」** 圖示。
    *   在 **「版本」 (Version)** 下拉選單中，務必選擇 **「建立新版本」 (New version)**。
    *   設定 **「誰有存取權」 (Who has access)** 為 **「所有人」 (Anyone)**。
    *   點擊 **「部署」 (Deploy)** 按鈕。
4.  **複製網址**：
    *   系統會顯示 **Web App URL**，請複製此網址。網址應以 `https://script.google.com/macros/s/` 開頭。

> [!WARNING]
> **請勿填入 Google 試算表 (Spreadsheet) 的網址！** 
> 試算表網址僅供管理員查看後台資料，排課系統需要的是 GAS 「部署」後產生的 Web App 網址。若填錯網址，系統會顯示橘色警告訊息。

> [!IMPORTANT]
> 若只按「儲存」而沒有執行「部署 -> 建立新版本」，前端網頁將持續收到舊版的程式回應！

---

## 4. 預約操作流程

系統操作設計為由上而下的直覺式流程：

### 步驟 1：選擇老師
*   從下拉選單選擇您的姓名。
*   **新增老師**：若名單中沒有您的名字，請點擊右側 `+` 按鈕，輸入姓名與地區後新增。系統會自動記憶並加入該地區的清單。

### 步驟 2：選擇日期與地區
*   **日期**：點選日曆選擇預約日期。系統會自動顯示對應的 Google Sheet 年月份 (例如 `115/1`)。
*   **地區**：選擇 **台北伊美**、**台中伊美** 或 **高雄伊美**。
    *   **注意**：切換地區時，系統會自動切換至該地區專屬的 Google Sheet 資料庫，並重新載入該地區的老師名單與課程內容。

### 步驟 3：選擇科目 (教室)
*   依據您選擇的地區，可選科目會有所不同：
    *   **台北伊美**：學科、彩妝、造型、**SPA**、護膚。
    *   **台中/高雄**：學科、彩妝、造型、護膚、**實習**。

### 步驟 4：選擇時段
*   **多選功能**：點擊時段卡片即可選取，可一次點選多個連續或不連續的時段。
*   **狀態顯示**：
    *   <span style="color:green">● 可選</span>：時段為空，可預約。
    *   <span style="color:gray">● 已滿</span>：該時段已被他人預約，卡片會顯示預約者姓名 (例如：`伊美(彩妝)` ) 且無法點選。

### 步驟 5：填寫細節與送出
*   **課程內容 (選填)**：輸入課程名稱 (例如：基礎彩妝)。系統提供「常用內容」快速按鈕，您也可以點擊 `+` 新增常用的課程名稱。
*   **學生人數**：調整學生人數 (1-5人)。
*   **確認登記**：點擊底部深藍色按鈕送出。系統會依序處理您的預約請求。

---

## 5. 常見問題排除 (Q&A)

### Q1: 為什麼我更新了 `Code.gs`，網頁上還是舊的資料/反應？
**A:** 請參閱第 3 點。您極有可能忘記在部署時選擇 **「建立新版本 (New version)」**。Google 的 Web App 機制要求每次代碼變更都要發布新版才會對外生效。

### Q2: 為什麼台北伊美沒有「實習」選項？
**A:** 系統已根據需求客製化。台北伊美的配置為 **SPA** 教室，而無實習教室；台中與高雄則保留實習教室。

### Q3: 畫面顯示「網址格式不正確」或出現橘色警告？
**A:** 這表示您在網頁上方的 GAS 網址欄位填入了錯誤的連結。請確保填入的是以 `/macros/s/` 開頭的部署網址，而不是 `/spreadsheets/d/` 開頭的試算表連結。

### Q4: 畫面顯示「目前使用模擬模式 (資料不會儲存)」？
**A:** 這是正常現象。若您沒有填入 GAS 網址，系統會自動進入模擬測試模式。此模式下您可以自由測試功能，但資料不會真的寫入 Google 試算表。要切換回真實模式，請填入正確的 GAS 網址。

### Q5: 畫面顯示「讀取課表失敗」或一直轉圈圈？
**A:**
1.  請檢查您的網路連線。
2.  請確認 GAS 部署時，**「誰有存取權」** 是否設定為 **「所有人 (Anyone)」**。若設定為「僅限我」，系統會因為權限不足而無法讀取。
3.  請確認 Google 試算表權限是否已開啟。
4.  確認目前選擇的地區，其對應的 Google Sheet ID 是否正確設定在 `Code.gs` 中。

### Q6: 如何新增新的地區表格？
**A:** 目前系統 `Code.gs` 中設定了三個地區的 ID。若需變更或新增，請聯絡系統管理員修改 `Code.gs` 中的 `SHEET_IDS` 設定並重新部署。

---

## 6. 技術資訊
*   **前端架構**：React, TypeScript, Tailwind CSS
*   **後端架構**：Google Apps Script (GAS)
*   **資料庫**：Google Sheets (多檔案架構)
